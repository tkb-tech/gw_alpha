import gwdet
import numpy as np
import scipy
from scipy import integrate
import math
import random
import matplotlib.pyplot as plt
from mpl_toolkits.axes_grid1 import make_axes_locatable
import time

H_0 = 70.0 #[(km/s)/Mpc]
c = 299792.0 #[km/s]
o_M = 0.3
o_k = 0.0
o_l = 0.7
s_s = 100

#create dV/dz(z) start!

def E(x):
    y = o_M*(1+x)**3 - o_k*(1+x)**2 + o_l
    result = np.sqrt(y)
    return result


#describe comoving distance from redshhift x.
def D_c(x):
    
    def g(y):
        return 1/E(y)
    
    f = integrate.quad(g,0,x)
    
    return f[0]*c/H_0


def dVdz(z):
    
    x = (4*(np.pi)*c/H_0)*(D_c(z))*(D_c(z))/E(z)
    return x

#dV/dz is completed!


##describe R_th

#describe cosmic time at merger event.

Const_in_R_th = 0.01

def t_c(z):
    def f(a):
        y  = o_M/a - o_k + o_l*a*a
        result = np.sqrt(y)
        return result
    def g(a):
        result = 1.0/f(a)
        return result
    
    result = integrate.quad(g,0,1.0/(1.0+z))

    return result[0]/H_0


#describe about mass function
sigma = 0.6
m_c = 20.0 #unit is solar mass.


def f(m):
    return ( 1/ ( np.sqrt(2.0*np.pi) * sigma * m ) ) * math.exp( -( math.log(m/m_c) )**2.0 / ( 2.0 * sigma**2.0 ) )

"""

m_max = 50.
m_min = 5.

def f(m):
    if m_min < m and m < m_max:
        return 1.0
    else:
        return 0.0

"""

def h(m):
    return m**(3.0/37.0) * f(m)


def R_th( m_1 ,m_2 ,z):
    return Const_in_R_th * t_c(z)**(-34.0/37.0) * ( m_1 + m_2 )**( 36.0 / 37.0 ) * h( m_1 ) * h( m_2 )


#p = gwdet.detectability()


alpha = 1.

def dR_det(m_1,m_2):
    if m_1 <= 0.0:
        return 0.0
    elif m_2 <= 0.0:
        return 0.0
    else:
        return ( m_1 + m_2 )**( alpha ) * h( m_1 ) * h( m_2 )

def dR_dmt_dq(m_t,q):
    return m_t/(1+q)**2*dR_det(m_t*q/(1+q),m_t/(1+q))




#calculate the average of m1,m2 in dR_det.

integ1 = integrate.dblquad( lambda x,y: x*dR_det(x,y) , 0.1 , 150. , lambda x: 0.1 , lambda x:150. )

integ2 = integrate.dblquad( lambda x,y: (x+y)*dR_det(x,y) , 0.1 , 150. , lambda x: 0.1 , lambda x:150. )

denomi = integrate.dblquad( lambda x,y: dR_det(x,y), 0.1 , 150., lambda x: 0.1 , lambda x: 150. )

print(integ1[0]/denomi[0])
print(integ2[0]/denomi[0])




#plot mass distribution in plane.
n_m=1000
n_q=700

m_t_min = 10.
m_t_max = 100.
dm_t = (m_t_max - m_t_min)/n_m

q_min = 0.1
q_max = 0.95
dq = (q_max - q_min)/n_q
sum_int = 0.
dist_m = np.array([])
mav = 0.
sum_logmt = 0.
logmt = np.array([])
t1 = time.time()
for i in range(0,n_m):
    m_t = dm_t * (i) + m_t_min
    for j in range(0,n_q):
        q = dq * (j) + q_min
        valu = (dR_dmt_dq( m_t , q ) + dR_dmt_dq( m_t + dm_t , q ) + dR_dmt_dq( m_t , q + dq ) + dR_dmt_dq( m_t + dm_t , q + dq ) + dR_dmt_dq( m_t + dm_t/2. , q + dq/2. ) )/ 5.
        logu = valu * math.log(m_t)
        logmt = np.append( logmt, logu )
        sum_logmt = sum_logmt + logu
        dist_m = np.append( dist_m, valu )
        sum_int = sum_int + valu
        
sum_logmt = sum_logmt/sum_int

for i in range(0,dist_m.shape[0]):
    dist_m[i] = dist_m[i]/sum_int
    logmt[i] = logmt[i]/sum_int

t2 = time.time()

print('the time to calculate is')
print(t2-t1)

logmatrix = logmt.reshape((n_m,n_q))
matrix = dist_m.reshape((n_m,n_q))

np.save(
    "10.<mt<100._0.1<q<0.95_alpha="+str(alpha)+"_"+str(n_m)+"_"+str(n_q),  # ファイル名
    matrix # 保存したいオブジェクト
)
np.save(
    "10.<mt<100._0.1<q<0.95_alpha="+str(alpha)+"_"+str(n_m)+"_"+str(n_q)+"_log",  # ファイル名
    logmatrix # 保存したいオブジェクト
)


"""
t1 = time.time()
matrix = np.load('10.<mt<100._0.1<q<0.95.npy')
logmatrix = np.load('10.<mt<100._0.1<q<0.95_log.npy')
t2 = time.time()

sum_logmt = np.sum(logmatrix)

print('the loading time is')
print(t2-t1)
"""


ax = plt.subplot(111)

im = ax.imshow(matrix)
# create an axes on the right side of ax. The width of cax will be 5%
# of ax and the padding between cax and ax will be fixed at 0.05 inch.
divider = make_axes_locatable(ax)
cax = divider.append_axes("right", size="5%", pad=0.05)

plt.colorbar(im, cax=cax)

plt.show()



samples = [
[ 20.71420299882093 , 34.45081533040103 ],
[ 39.20380206831631 , 48.98707434614329 ],
[ 80.58446332695185 , 22.246492552987437 ],
[ 33.62911818553615 , 36.40923969074904 ],
[ 13.066615769296028 , 37.82867507770657 ],
[ 23.642494679266022 , 42.88029389437891 ],
[ 28.415660687516933 , 9.618605361351493 ],
[ 23.78464820948202 , 24.073821141357225 ],
[ 39.588423115361365 , 17.16991789334486 ],
[ 18.956582725137153 , 47.35047732319452 ],
[ 46.53011323337044 , 33.91430383531601 ],
[ 27.302939611408135 , 74.95605117835193 ],
[ 23.343350784780842 , 66.73744351626617 ],
[ 42.35342512241674 , 71.3645618015025 ],
[ 34.46997275690887 , 25.542392076629877 ],
[ 36.63846186867194 , 26.02207135718689 ],
[ 42.64534897213788 , 26.572872798555338 ],
[ 31.270157209684918 , 17.472588973297334 ],
[ 40.53718982346728 , 28.164550228763684 ],
[ 26.772423707247068 , 22.121433871412794 ],
[ 58.32884989137453 , 10.450479288495716 ],
[ 52.577550273213575 , 13.112284103856 ],
[ 21.126584366269963 , 8.475562889281216 ],
[ 21.994947522152522 , 17.24582111482623 ],
[ 23.512408481704362 , 14.461498223385703 ],
[ 52.52515824633311 , 33.497773029844936 ],
[ 43.101351729270235 , 68.15449263062632 ],
[ 26.444896943513136 , 15.033152470266216 ],
[ 20.7535113413507 , 25.58686146533749 ],
[ 7.863348186018982 , 25.760897072080798 ],
[ 24.353094847239426 , 28.39468519611649 ],
[ 34.94838389195157 , 55.40929032959667 ],
[ 19.51662230064708 , 98.46920471473263 ],
[ 22.397234100635973 , 171.18894262052578 ],
[ 34.3277698428157 , 160.5678330992126 ],
[ 50.02266176367104 , 142.13562987347913 ],
[ 23.062456905550256 , 173.39062862748554 ],
[ 11.31674766783565 , 174.6336302686933 ],
[ 20.316882153640805 , 124.63069984545169 ],
[ 44.83533375380411 , 74.56597304628595 ],
[ 27.937509508610916 , 67.79762458324511 ],
[ 35.30610909201137 , 49.76585577253472 ],
[ 31.365906213121413 , 15.94635825451953 ],
[ 45.51191693288725 , 21.579092802481238 ],
[ 42.66777038423987 , 34.465995444725856 ],
[ 56.19994983950989 , 19.590381367591426 ],
[ 44.791801187118224 , 9.498407248156374 ],
[ 37.93686548701995 , 52.89038786599245 ],
[ 12.201969727680774 , 10.564677365274825 ],
[ 11.038018388865808 , 89.12894692760814 ],
[ 27.29038626648018 , 89.82479620168179 ],
[ 14.861601934116475 , 41.675801085856456 ],
[ 17.088152288172566 , 6.861405124317875 ],
[ 22.34509829154256 , 15.660367683803615 ],
[ 47.40516294438601 , 19.661237029182182 ],
[ 56.37030830797881 , 23.219288301285783 ],
[ 27.468919348695138 , 7.31087623510248 ],
[ 21.074151211473193 , 23.550697576563152 ],
[ 7.882669150697941 , 25.303530584043795 ],
[ 24.124287707269858 , 30.516043243802613 ],
[ 15.994260766025526 , 40.047334408165895 ],
[ 25.887099277407618 , 28.898700007501922 ],
[ 26.952876304724413 , 26.054074952846598 ],
[ 14.335632467413149 , 60.664715005620934 ],
[ 10.649589392456715 , 55.55751933764565 ],
[ 23.333320227060945 , 52.74414985450853 ],
[ 59.209911259732365 , 10.927435183081716 ],
[ 62.673260766342636 , 18.99578151465382 ],
[ 24.943147721519203 , 9.866861291492762 ],
[ 13.001451107691501 , 10.310056593576347 ],
[ 16.644769014189166 , 59.28773334523613 ],
[ 69.02354078091456 , 21.757677736469926 ],
[ 40.620964773118004 , 12.392100196453905 ],
[ 36.94951476531506 , 23.11048831130271 ],
[ 16.90817777047387 , 9.588391326764333 ],
[ 27.712855107755527 , 15.22830378481318 ],
[ 13.508034310033175 , 16.780789037082744 ],
[ 49.77816394283614 , 11.047961957358046 ],
[ 12.626201731929186 , 10.848966114664218 ],
[ 26.77050107552307 , 20.74734372181234 ],
[ 42.997911264364504 , 46.13339561578727 ],
[ 32.37891253965527 , 19.700003735256736 ],
[ 28.955910237690237 , 8.637079531489771 ],
[ 22.645097624693697 , 17.41889491129367 ],
[ 42.69490236623903 , 17.329871171146056 ],
[ 31.877445037443877 , 16.370646375227366 ],
[ 28.36648756229182 , 44.18415115567022 ],
[ 8.483004583333994 , 24.65362033997524 ],
[ 26.214049774428712 , 26.791641389875295 ],
[ 39.428007553016805 , 27.00945675225788 ],
[ 20.552515344355957 , 23.41941950552146 ],
[ 17.704972050185003 , 25.941028026821826 ],
[ 24.59320529153495 , 9.929784902362638 ],
[ 31.957929630856583 , 30.555615523789548 ],
[ 20.35471150874079 , 31.923797626227344 ],
[ 45.43362160838276 , 10.766935939858607 ],
[ 30.1205571743469 , 28.24714018747651 ],
[ 9.500542486634316 , 17.843103067310516 ],
[ 12.797609410917703 , 22.19396507332739 ],
[ 17.8959541918587 , 49.990539817112946 ],
[ 13.945067181265626 , 14.01732656900424 ],
[ 14.822981230282299 , 14.764337473769288 ],
[ 14.040289964348048 , 24.06683200515572 ],
[ 24.536816950860313 , 18.536611125765173 ],
[ 33.765207612131164 , 15.147853212875777 ],
[ 62.78667670677268 , 7.368052913592685 ],
[ 52.795068522459175 , 19.487059607432926 ],
[ 27.930809128313992 , 40.58946108725052 ],
[ 13.053181534845582 , 22.096977630977893 ],
[ 16.51689953870834 , 6.711504502091621 ],
[ 58.28366659188666 , 37.29505890760629 ],
[ 24.27995540583169 , 16.221061981611413 ],
[ 40.77132737759914 , 14.848309479158 ],
[ 49.421806938628 , 46.72355493988578 ],
[ 16.84047802197805 , 17.73721189701754 ],
[ 16.68002964229351 , 39.48734160248435 ],
[ 13.574371079587669 , 20.442139488150328 ],
[ 25.125434339997295 , 14.704433660834798 ],
[ 24.986555007061636 , 40.214379796538665 ],
[ 39.76489026510632 , 14.76059963589032 ],
[ 16.903749207161255 , 33.45553696701117 ],
[ 69.03532462485208 , 44.68312848589588 ],
[ 44.603921375747575 , 22.223111523900904 ],
[ 93.24948211776777 , 9.776872849056392 ],
[ 86.11200310276436 , 27.98687672275083 ],
[ 88.12007861448147 , 8.36883089497827 ],
[ 34.636315053498905 , 26.571347226147765 ],
[ 39.68241138625244 , 14.3231900872313 ],
[ 19.537671557473665 , 37.08443365210764 ],
[ 12.685103214380815 , 73.4176031017668 ],
[ 16.625996849612285 , 28.981186936636536 ],
[ 26.941111656765905 , 8.754556440550509 ],
[ 15.621487606720837 , 12.340865497707263 ],
[ 41.89646248926441 , 29.770212687564367 ],
[ 51.77145187304827 , 31.40088232168235 ],
[ 38.5850156242483 , 13.38654094303443 ],
[ 15.144180910498505 , 116.41698230441406 ],
[ 19.596813450286902 , 64.40183574306563 ],
[ 15.746074871926398 , 24.944576783199487 ],
[ 20.71863083855166 , 14.293994884447791 ],
[ 31.74246957432677 , 7.776789860825961 ],
[ 16.78025627613961 , 11.226280527092468 ],
[ 13.386806009203825 , 27.5168220489849 ],
[ 10.021168520799144 , 29.218376752215086 ],
[ 8.410624831078595 , 22.30416134563602 ],
[ 46.549733495164546 , 8.075020574684233 ],
[ 10.477147531092411 , 35.394148305289896 ],
[ 23.69357524963963 , 22.928525726313215 ],
[ 35.978400060792566 , 26.49470485391971 ],
[ 28.23521803907464 , 13.383782739684356 ],
[ 12.120835093336579 , 23.622778125746372 ],
[ 29.506484518317148 , 36.238806894948624 ],
[ 21.063842612134422 , 30.685282471481035 ],
[ 34.397258176524616 , 15.749403291340865 ],
[ 42.96079039411873 , 66.08903272395494 ],
[ 57.337655630770506 , 45.53983717737529 ],
[ 139.1263016837842 , 15.04670879217441 ],
[ 134.99725387129007 , 20.809725895470056 ],
[ 79.85054652400053 , 20.94937489107536 ],
[ 75.40248901963116 , 30.916574889447734 ],
[ 86.97534196072604 , 5.228881939462987 ],
[ 118.26996134219854 , 22.802282359345355 ],
[ 83.06281849110643 , 41.24543198798314 ],
[ 16.147931898466947 , 21.83325125201056 ],
[ 18.126009056202275 , 17.410409361571872 ],
[ 73.02161585021042 , 20.66324917251786 ],
[ 78.52810765618263 , 25.298169827338782 ],
[ 18.592804478595863 , 86.73066868559916 ],
[ 27.254460288743914 , 31.42317235546554 ],
[ 19.316594334288354 , 34.08049390456054 ],
[ 13.934947707257546 , 23.43675441738814 ],
[ 57.23266602300668 , 36.854415657419324 ],
[ 21.502440788821758 , 22.467310905181648 ],
[ 40.45675258541048 , 15.296397654459742 ],
[ 47.56702941842147 , 78.94552055932235 ],
[ 5.111745780246518 , 49.60976963182685 ],
[ 18.663685011400656 , 47.85685618895545 ],
[ 48.14519037287417 , 66.50809994673928 ],
[ 45.821867396912616 , 83.0513749364267 ],
[ 17.77153746777631 , 46.93252791511388 ],
[ 30.17357063045806 , 14.186147234044805 ],
[ 27.485184918418295 , 33.50536384241163 ],
[ 27.046038625190427 , 57.04957938618059 ],
[ 10.06308459585992 , 36.72077150116689 ],
[ 22.21456401290668 , 36.38018574773075 ],
[ 36.628304980198045 , 14.712840622294156 ],
[ 18.366059414718478 , 22.707228451250835 ],
[ 52.65973433300581 , 12.54663209917075 ],
[ 8.726235909809965 , 14.286164225418219 ],
[ 48.25802822809537 , 21.994607678293058 ],
[ 46.67590209814655 , 41.59943386680775 ],
[ 102.54189068841046 , 16.109619380018472 ],
[ 19.8543472231547 , 60.214514845155605 ],
[ 33.70441905710806 , 53.80809792712212 ],
[ 28.57350453103511 , 16.778342267973006 ],
[ 17.03137521150525 , 42.28342579242424 ],
[ 7.004906041109296 , 19.19058493318778 ],
[ 16.366705842623713 , 20.2763324708748 ],
[ 21.492743474185396 , 20.31710080375911 ],
[ 37.310225387161786 , 20.810989168588023 ],
[ 19.0746489293732 , 6.7852567542371 ],
[ 29.042665920412055 , 46.40125447331498 ],
[ 17.44963717400448 , 13.605798215268376 ],
[ 11.940603502543912 , 23.790475001214247 ],
[ 40.90818010122651 , 9.105613192539344 ],
[ 24.357777180643104 , 33.415585982518714 ],
[ 26.283905918981006 , 8.255878310946585 ],
[ 40.43640259472417 , 13.265075160465269 ],
[ 51.891592212126916 , 38.946515926971955 ],
[ 23.011003621967994 , 21.632132707982734 ],
[ 35.07094701123269 , 13.074760636882779 ],
[ 21.12321325081731 , 14.964312485160955 ],
[ 36.49487121838315 , 15.883918868839114 ],
[ 72.82285612054602 , 24.194488536914754 ],
[ 67.54260211037729 , 15.524519023847379 ],
[ 19.29939653121602 , 7.784144291447187 ],
[ 8.95963844734963 , 56.54571996613615 ],
[ 17.25462072081614 , 40.64435726677678 ],
[ 27.634942500536283 , 15.043123952054064 ],
[ 41.57350109113211 , 14.025244162844421 ],
[ 7.793280503528948 , 12.994770367663794 ],
[ 9.581959389628013 , 17.325883920840365 ],
[ 8.08686332348591 , 12.611970809890952 ],
[ 64.46399269253234 , 13.370789858452948 ],
[ 92.23138756043056 , 17.59363280904122 ],
[ 67.87784553287815 , 7.9966545080492555 ],
[ 88.99278570163662 , 22.70929975216349 ],
[ 31.861097541903007 , 19.525940406164775 ],
[ 13.801580238545295 , 37.39356894251332 ],
[ 18.752862416158386 , 45.752925442341834 ],
[ 70.16130322611625 , 11.74174463499231 ],
[ 54.067559141652396 , 35.8935797235355 ],
[ 24.140217776758085 , 18.27150591318179 ],
[ 47.231082229038805 , 20.2038880242176 ],
[ 19.097706725245143 , 13.170220745888246 ],
[ 12.16499800444389 , 30.36846001665667 ],
[ 20.510489506932046 , 30.04077761810791 ],
[ 9.161976365015315 , 41.09161742968199 ],
[ 20.04381079852901 , 24.4616658245129 ],
[ 23.82391489588269 , 48.2787650309941 ],
[ 58.94334654915425 , 49.09770532502296 ],
[ 60.18399436384614 , 37.160665335433734 ],
[ 13.833993983664698 , 107.05381631275131 ],
[ 21.84030910757232 , 135.81063975890387 ],
[ 24.43152555642373 , 216.13359778177204 ],
[ 30.923754687432936 , 217.93208081889364 ],
[ 20.45339123786685 , 167.54681079854197 ],
[ 18.738576868846366 , 133.06449595691575 ],
[ 31.88895092077614 , 152.32589205001582 ],
[ 12.266581139873637 , 122.59519126668908 ],
[ 38.13689548203962 , 24.121142140684196 ],
[ 48.066283213749486 , 45.399574311319796 ],
[ 30.832965377028636 , 25.44759396920395 ],
[ 16.599793769156417 , 36.97434730106217 ],
[ 10.065964770617493 , 38.17299483244615 ],
[ 24.77061870784354 , 27.995713472554257 ],
[ 19.00444746234764 , 26.67612686078313 ],
[ 11.173698078922024 , 29.190974605273475 ],
[ 27.68252735161623 , 30.375444384047185 ],
[ 40.330798223159164 , 16.472175971291783 ],
[ 17.5481492423709 , 28.209417423026423 ],
[ 26.22297664824519 , 24.696753793391196 ],
[ 30.502409413637466 , 20.388133099011696 ],
[ 31.07200982377154 , 21.440084664589378 ],
[ 8.08216139150161 , 47.07801857018981 ],
[ 8.377473343185342 , 51.110158236504645 ],
[ 24.66693389247531 , 71.09159117183147 ],
[ 34.71791904028819 , 20.3168536980794 ],
[ 15.475713532969273 , 24.122527502023125 ],
[ 7.579401560213484 , 30.52028233993019 ],
[ 11.221471971572358 , 17.48997864206555 ],
[ 14.633848798008303 , 13.862747312409663 ],
[ 13.227728857054418 , 32.43903237033883 ],
[ 27.689438760774046 , 15.559061603767713 ],
[ 14.46977419200634 , 65.84049998430446 ],
[ 18.324292477291632 , 33.30404458143606 ],
[ 13.756689812593798 , 27.38145509364896 ],
[ 38.210116288703844 , 10.662607388593553 ],
[ 49.51263402281394 , 18.752503583092732 ],
[ 15.314700677159488 , 36.46691951804978 ],
[ 27.20909265933087 , 31.7889604145782 ],
[ 28.30851467066679 , 12.357992079491545 ],
[ 13.834797933396938 , 34.04326516085115 ],
[ 11.96304712059265 , 23.873272489815424 ],
[ 32.410044361335636 , 41.104387541525156 ],
[ 22.68518857628915 , 26.673352676658972 ],
[ 28.925869919969518 , 14.134617913466922 ],
[ 14.678786716259848 , 16.800445444430096 ],
[ 24.5638299587918 , 26.924877281619143 ],
[ 18.18830443421863 , 7.079433179772408 ],
[ 11.409661962586194 , 36.31351882967314 ],
[ 11.764745056425383 , 51.8967097784251 ],
[ 34.08974964656467 , 25.520489144058256 ],
[ 18.67591125075875 , 32.037553140614605 ],
[ 16.53967712664839 , 28.07415875707089 ],
[ 30.294129975178453 , 41.77120107815868 ],
[ 15.588404299108994 , 37.04941866466701 ],
[ 18.32979691488192 , 11.70524130428154 ],
[ 6.362203163920995 , 27.06348600514752 ],
[ 12.135274159315989 , 9.253139376749374 ],
[ 12.135274159315989 , 9.253139376749374 ],
[ 19.489450389724972 , 13.774041962980226 ],
[ 38.06461481918494 , 12.079088992573519 ],
[ 30.634461351602276 , 15.145085711809422 ],
[ 12.319299826763906 , 12.383795932543308 ],
[ 44.502086504545396 , 18.63332172015486 ],
[ 37.96539048340802 , 10.990942673305838 ],
[ 15.580941976148264 , 17.508940167796254 ],
[ 3.449464362839617 , 35.008605097455664 ],
[ 15.983446250690893 , 55.13009206765863 ],
[ 46.735877881596096 , 17.80883782373354 ],
[ 26.043286800874142 , 20.878451675870224 ],
[ 22.17720399837064 , 13.439499663421364 ],
[ 30.514999109929036 , 7.280835124631942 ],
[ 43.05716081644704 , 14.316587088032994 ],
[ 19.007226118616508 , 16.398282248738184 ],
[ 22.575264891100154 , 8.927018759744081 ],
[ 59.7476641376804 , 18.81670254356211 ],
[ 30.185174644615742 , 45.17333941876872 ],
[ 20.264030191417408 , 48.620238286545906 ],
[ 31.37790461101367 , 29.401039664593746 ],
[ 25.797951640734414 , 26.565188866083204 ],
[ 46.453397136951324 , 35.025785166239395 ],
[ 25.462532729660037 , 27.869117304990745 ],
[ 10.04602039261771 , 26.210841206265425 ],
[ 31.81384641559798 , 23.55831933707023 ],
[ 38.61483575613144 , 17.74653312010095 ],
[ 25.381775294782344 , 25.59788733673992 ],
[ 10.885042710434805 , 29.935606304988493 ],
[ 13.785440787176924 , 23.276066222232384 ],
[ 13.498715766128326 , 44.85834235754577 ],
[ 18.24456712611463 , 12.971546315946222 ],
[ 23.200713997237767 , 17.43520459892701 ],
[ 53.27461466247875 , 12.729826024160394 ],
[ 24.093912702462262 , 14.434637732202116 ],
[ 7.7825654528225465 , 10.664130832212894 ],
[ 16.95383119930231 , 9.573575957092977 ],
[ 32.037234521677355 , 28.857213438600024 ],
[ 18.441499469508194 , 47.00402554917503 ],
[ 12.13621845213597 , 16.574937481030148 ],
[ 10.019159720352992 , 23.6272439013949 ],
[ 18.670797283262715 , 16.64691775312143 ],
[ 35.89847779400777 , 46.404171815383535 ],
[ 31.29033210059508 , 17.799140068617437 ],
[ 7.377990750901154 , 45.808002821329076 ],
[ 25.114037231183204 , 11.578926421450529 ],
[ 25.605711162531485 , 20.932397568263383 ],
[ 15.872577520088932 , 11.900943713403626 ],
[ 11.55955753151902 , 13.88567906529679 ],
[ 8.591740786288895 , 48.529168608549696 ],
[ 21.118125126872837 , 45.28260270158212 ],
[ 39.1174843182293 , 9.35375465143317 ],
[ 58.38621041507123 , 14.885368497851632 ],
[ 20.588732416306566 , 29.685451622416664 ],
[ 35.31881254005542 , 46.912538554502504 ],
[ 10.708355085031164 , 15.781562127747248 ],
[ 17.114869510273884 , 56.08136501873684 ],
[ 35.674524854131974 , 20.982135540770066 ],
[ 36.019924063032555 , 15.846824427033264 ],
[ 18.61026293887221 , 32.81140595929941 ],
[ 29.796104971025386 , 12.206043799852244 ],
[ 31.562025828577507 , 23.67661494650325 ],
[ 15.272630051005581 , 12.240254566046815 ],
[ 16.9899485922017 , 16.497806944425957 ],
[ 9.018918316180226 , 24.819807735523888 ],
[ 21.179788613950887 , 36.88368483466847 ],
[ 27.00972376388867 , 16.405992530500434 ],
[ 43.72826310577966 , 21.502194454968127 ],
[ 27.055959152709605 , 21.877912352308506 ],
[ 30.54931407766825 , 12.244347251992032 ],
[ 18.471170512591776 , 12.203543456889106 ],
[ 22.158287487082816 , 30.385365381997286 ],
[ 46.04671941158752 , 21.731213674564255 ],
[ 22.93324539181113 , 48.8362390287673 ],
[ 12.873419961284656 , 38.3284385072471 ],
[ 13.386507692425589 , 20.190020393720438 ],
[ 112.448225022071 , 25.260968962392212 ],
[ 94.62479949118597 , 12.48336240780515 ],
[ 77.82414848453884 , 13.541760705808837 ],
[ 43.70280111571228 , 4.829300775484803 ],
[ 18.422802976936705 , 49.31549187865485 ],
[ 6.404113837742358 , 8.216721656816835 ],
[ 47.24988012922901 , 16.9396114281449 ],
[ 17.30287859402174 , 64.26929299715076 ],
[ 63.943514576939535 , 24.473721587951488 ],
[ 52.320420175419564 , 8.441627597848495 ],
[ 55.68656975327701 , 19.492150531297202 ],
[ 44.686343392278104 , 10.503264724745058 ],
[ 15.815046882731608 , 23.344891887217347 ],
[ 51.37800962782342 , 16.621156795889288 ],
[ 21.001592468350267 , 29.220160949563308 ],
[ 11.482274717815997 , 30.110723885943855 ],
[ 29.288497557093947 , 36.052105371539355 ],
[ 8.785617476764049 , 45.98636271916062 ],
[ 70.91755869766544 , 42.38927375933007 ],
[ 77.87155932125913 , 53.00482133784186 ],
[ 41.02864551532749 , 22.428899512945875 ],
[ 48.796275633016066 , 4.087518860700505 ],
[ 35.76921925423841 , 49.347865562830464 ],
[ 17.805096245712583 , 17.190684952635593 ],
[ 10.73414405115764 , 44.09944630545078 ],
[ 14.384625043148926 , 25.75218668996056 ],
[ 34.16374538534822 , 34.164640045235515 ],
[ 54.27447233464605 , 15.366898618126807 ],
[ 33.64397909253101 , 21.051139271117158 ],
[ 31.532869695442248 , 13.558681386125409 ],
[ 22.75211413091467 , 19.793860540433002 ],
[ 9.320892161559627 , 27.09671406253537 ],
[ 49.707305897760385 , 32.39150377717432 ],
[ 28.176930748621622 , 12.269845455876727 ],
[ 49.29422129941567 , 34.48996952051269 ],
[ 22.946826780278624 , 32.213542103326375 ],
[ 18.796826634710857 , 19.66465017436107 ],
[ 9.400704240468617 , 13.227331866959341 ],
[ 14.21801891215088 , 17.29632057145662 ],
[ 22.253593231645123 , 17.61396464674595 ],
[ 23.583462410194556 , 11.478527414649742 ],
[ 9.066031101311168 , 28.395363856543398 ],
[ 37.54936922215828 , 50.51141384921314 ],
[ 70.86725341246311 , 25.029221732326278 ],
[ 31.503718690311302 , 14.753343660822388 ],
[ 22.728074150508565 , 35.46239904970125 ],
[ 31.845548338469825 , 41.080270256489385 ],
[ 13.84591004065471 , 37.61035148472069 ],
[ 66.10957153967173 , 22.005529727621322 ],
[ 37.64436853299905 , 19.22639165290783 ],
[ 69.94630015280171 , 12.521148805347174 ],
[ 73.12785789624617 , 34.86476377527453 ],
[ 16.301299123665427 , 43.148916378708485 ],
[ 27.46609876503704 , 60.19956595797797 ],
[ 28.586232994153676 , 14.726990111278695 ],
[ 21.198850015590015 , 27.766336947528384 ],
[ 27.96637710143196 , 27.5111673323252 ],
[ 58.038045411970614 , 21.659526403839354 ],
[ 56.25233002851292 , 13.14452070534924 ],
[ 32.54925177546642 , 12.73963765385584 ],
[ 13.869757371415348 , 35.842357205493364 ],
[ 44.78778028615348 , 91.52717400534388 ],
[ 38.187626954864875 , 71.13284648703724 ],
[ 12.878584046969083 , 55.98156939119657 ],
[ 18.51349760602159 , 44.396912058177 ],
[ 39.435816098962945 , 38.895914461390184 ],
[ 70.69695104189785 , 25.60927357742799 ],
[ 56.30152334367054 , 15.691326148850724 ],
[ 53.7885787862917 , 69.48752017556195 ],
[ 28.70511100541583 , 10.844807776215525 ],
[ 20.355785123755176 , 35.284835881938264 ],
[ 15.610462745721168 , 15.701253518437547 ],
[ 21.42939872090858 , 37.58455810706225 ],
[ 34.01514619887634 , 28.98053941754678 ],
[ 49.77572252813222 , 16.802278504887916 ],
[ 49.46821948596567 , 18.105095219803566 ],
[ 44.76267319734249 , 13.446557415801783 ],
[ 18.627616856241282 , 33.19348817796439 ],
[ 20.036235011520642 , 12.498725474980764 ],
[ 10.592393892485987 , 45.76614072512939 ],
[ 24.53937221945666 , 29.99552018919378 ],
[ 47.48704194904821 , 24.02544938647148 ],
[ 21.950153623767267 , 8.024969291837134 ],
[ 19.179223781466412 , 14.217542214547965 ],
[ 32.379774096337094 , 15.41028832565717 ],
[ 26.826662924065758 , 37.36298886624502 ],
[ 76.43864038159022 , 11.591363894322093 ],
[ 12.464065694769246 , 23.01574766661935 ],
[ 28.28186419335431 , 12.42185119994525 ],
[ 26.086810384800817 , 19.703420997073827 ],
[ 45.39986028382582 , 66.98643421148782 ],
[ 10.795497647129368 , 26.85227409261998 ],
[ 8.45486369635497 , 30.414228294699512 ],
[ 12.358866194547739 , 17.09789958618527 ],
[ 30.40569005963654 , 43.71699945426452 ],
[ 26.007005425182896 , 18.794921374968872 ],
[ 13.192004452756226 , 16.92374843692457 ],
[ 23.083173293816362 , 15.917350559709861 ],
[ 22.49438915131445 , 14.940995940890275 ],
[ 20.97115485552261 , 11.49007148992316 ],
[ 24.562125936718054 , 55.590254127682584 ],
[ 18.23229124641861 , 79.17775372853015 ],
[ 27.643750597026624 , 89.58024078183664 ],
[ 36.148305950729586 , 116.52806536321752 ],
[ 11.10662281402027 , 71.64079387294852 ],
[ 15.313357535314665 , 63.4533592073032 ],
[ 4.472079775826071 , 30.549906723264186 ],
[ 14.25714126695783 , 62.13415293160427 ],
[ 17.45632470909617 , 26.67161766231827 ],
[ 7.689844038894577 , 27.165351900384696 ],
[ 22.916697960680736 , 41.5272486414124 ],
[ 13.543144435015112 , 13.424062600646284 ],
[ 9.837290420868486 , 22.581154025602842 ],
[ 57.489654391784065 , 32.081716000917964 ],
[ 19.295961110834753 , 7.520678148470804 ],
[ 30.24863829640482 , 17.87067263516695 ],
[ 76.99498884683699 , 13.255511897541748 ],
[ 29.194207415268032 , 16.903496589837676 ],
[ 15.926180797965383 , 15.867736252904743 ],
[ 28.581559284934272 , 8.241717015047302 ],
[ 17.605447135807093 , 15.233412733253562 ],
[ 17.605447135807093 , 15.233412733253562 ],
[ 75.17656184914311 , 29.23891917482719 ],
[ 32.16475257134553 , 16.403365796997928 ],
[ 14.77955279765817 , 31.121942426588415 ],
[ 26.23035648504498 , 33.461490079647305 ],
[ 45.45724402249279 , 15.363627097211543 ],
[ 30.531711628301956 , 12.337979410200216 ],
[ 29.41627798282161 , 58.97723717454234 ],
[ 41.125860529523756 , 90.19971324195441 ],
[ 19.851409073636212 , 69.50449179904733 ],
[ 37.9311543680783 , 16.10222674497708 ],
[ 34.72161253889318 , 46.25121243278257 ],
[ 38.107574074055755 , 5.6656814583406785 ],
[ 17.465909440138034 , 12.308268649181736 ],
[ 11.523544386056365 , 26.117209235303594 ],
[ 11.988842486079083 , 6.810132965744405 ],
[ 23.483959087878524 , 31.167476022660978 ],
[ 9.993358766051832 , 34.90550473124971 ],
[ 9.564593569088718 , 45.15799520664234 ],
[ 30.108617138555417 , 60.71566597991772 ],
[ 12.644809909248353 , 32.47888207916135 ],
[ 8.921278873988335 , 18.736449081445762 ],
[ 25.506821972453324 , 29.141078353500767 ],
[ 25.331725684086383 , 27.71752000418316 ],
[ 50.93701918966993 , 14.160710908837206 ],
[ 38.61124880382742 , 33.9440192465927 ],
[ 14.909718289084049 , 35.12564477733215 ],
[ 34.54771440155324 , 33.782434488721904 ],
[ 28.626545744466966 , 19.13220537432883 ],
[ 25.153992741117925 , 11.157103931104093 ],
[ 21.881708138538368 , 17.937918197525388 ],
[ 17.36512257600426 , 15.150435216851143 ],
[ 20.238737568737307 , 36.06412616882575 ],
[ 20.95221465131379 , 11.63238393185835 ],
[ 22.2066429130571 , 16.41281783850771 ],
[ 20.129231157593527 , 69.69240401835445 ],
[ 16.957911286893253 , 22.083830743951943 ],
[ 33.06789009988276 , 12.012125263004574 ],
[ 11.8576586221802 , 7.927541451110312 ],
[ 18.737533525339877 , 26.600660383606936 ],
[ 14.518545347371763 , 20.405482753377882 ],
[ 20.303185653495255 , 27.373591994411363 ],
[ 23.753507784791694 , 43.07565754253251 ],
[ 18.373226842810602 , 12.007056633098134 ],
[ 16.00482865722538 , 8.92870737075042 ],
[ 6.379516471831451 , 28.926602951242558 ],
[ 16.66996774906009 , 4.621829681452256 ],
[ 48.0777130872999 , 9.58244776075921 ],
[ 68.61408188717398 , 21.94570760854245 ],
[ 29.925039199433172 , 21.51011880761567 ],
[ 28.739567409361296 , 17.551574660746663 ],
[ 22.116918181353594 , 77.17802917337634 ],
[ 19.611788190090927 , 58.89869837294096 ],
[ 20.94686328382383 , 25.666437738133872 ],
[ 42.21584032904303 , 6.748880062468848 ],
[ 93.58426671153258 , 22.06302369380561 ],
[ 95.03003248612501 , 25.677441981967462 ],
[ 57.01259909133975 , 49.88435093709147 ],
[ 10.126717901468822 , 20.744649785644846 ],
[ 28.14588356551772 , 17.885405532641315 ],
[ 26.185547871898777 , 13.394696985696328 ],
[ 10.535512399832719 , 26.26593503716606 ],
[ 63.18224740859949 , 20.516691934535675 ],
[ 28.61442354974642 , 15.656352160871775 ],
[ 15.705983857124885 , 18.78868130512528 ],
[ 10.164099872329189 , 33.382585783065075 ],
[ 50.74841392013212 , 21.048862443178802 ],
[ 38.45909990726039 , 52.16589591091475 ],
[ 15.083959166722925 , 67.32642148682874 ],
[ 27.72298962807622 , 26.11606457196725 ],
[ 15.856618404019201 , 54.579653791590715 ],
[ 29.375383514815283 , 63.78202426935409 ],
[ 70.67853255954901 , 19.367476714130653 ],
[ 18.385149888735757 , 26.496885260338573 ],
[ 35.14525578521722 , 15.735531489673564 ],
[ 40.0498047914889 , 15.003717831064296 ],
[ 20.71084291195861 , 27.990676426247227 ],
[ 33.275418231508006 , 19.61107697430311 ],
[ 32.51435587365509 , 21.730111462445564 ],
[ 29.181616227391952 , 12.463418226480563 ],
[ 37.72761122666938 , 19.22669984961703 ],
[ 32.06600831874515 , 36.88642108798581 ],
[ 25.726159842232725 , 29.56787713953741 ],
[ 34.801095536027525 , 16.19416767187734 ],
[ 22.15845845291443 , 11.566055206802725 ],
[ 26.096706177985208 , 43.49107574572917 ],
[ 35.671835679071165 , 59.18049760143933 ],
[ 56.049461273456515 , 50.7581899616717 ],
[ 81.06833001102518 , 31.487696769919793 ],
[ 56.37793174483085 , 21.529503780242944 ],
[ 47.687716256244386 , 18.68700251791222 ],
[ 24.072574579918875 , 35.60284842109882 ],
[ 41.98269266626225 , 41.062374714061676 ],
[ 21.341404307925764 , 11.457705804558248 ],
[ 20.10843463544196 , 17.83489363232983 ],
[ 14.519650876485649 , 12.25259643885178 ],
[ 11.204689782974686 , 17.54309549502844 ],
[ 75.54172383757756 , 42.42713704958875 ],
[ 74.18500928060672 , 37.698732719733066 ],
[ 67.88779584137723 , 20.355325485735268 ],
[ 17.548184620332947 , 16.252144543587146 ],
[ 37.34203840978982 , 16.77049059106317 ],
[ 21.80119478938606 , 43.442796710075314 ],
[ 42.804616601865256 , 25.804017705933116 ],
[ 45.133959091927075 , 10.202883804384836 ],
[ 4.580085408901297 , 19.045074996779746 ],
[ 14.413466365023059 , 42.825902266824095 ],
[ 17.980912125981355 , 15.024720277834845 ],
[ 13.5262047238292 , 47.443982083941684 ],
[ 11.378836744050513 , 27.17956373076104 ],
[ 21.409092575679427 , 12.575977758905236 ],
[ 24.387196068185276 , 23.461645917873028 ],
[ 19.006651126695658 , 15.292193422430497 ],
[ 36.77244181350143 , 5.167457115344631 ],
[ 80.16522784211958 , 19.132113601096187 ],
[ 26.81468252310923 , 22.40172245264784 ],
[ 12.524699650076695 , 78.67632168944763 ],
[ 40.3667820759391 , 45.83824313778985 ],
[ 38.14108071598475 , 27.704963272237467 ],
[ 16.888718026073164 , 22.45805376531415 ],
[ 21.380412274339733 , 20.073877174951267 ],
[ 18.22115352474127 , 15.714317060615988 ],
[ 16.55514666598631 , 20.752922648427678 ],
[ 23.343445663949968 , 19.217596474674433 ],
[ 14.942359320705844 , 42.540914939694886 ],
[ 16.459047515840812 , 12.352387715394192 ],
[ 39.713219901830655 , 16.879008311789264 ],
[ 58.70911084371069 , 10.849609642908094 ],
[ 49.94861506429065 , 21.280066511623495 ],
[ 43.343932048898864 , 12.502721369946496 ],
[ 34.31225270485188 , 29.59125779421882 ],
[ 36.59058083507506 , 20.887034751399373 ],
[ 10.737480440350975 , 87.85428672850844 ],
[ 33.40837194873391 , 19.02698192198975 ],
[ 23.69490732357987 , 13.796742963961226 ],
[ 24.15568075399846 , 24.113280037630737 ],
[ 41.20718872095376 , 24.50017951845523 ],
[ 12.991577843646171 , 31.54523437447086 ],
[ 11.543568658896044 , 19.832057242050514 ],
[ 29.505437498738228 , 26.395469326159077 ],
[ 17.54676990185018 , 6.301901684805086 ],
[ 22.489522953084954 , 7.46308521991765 ],
[ 23.039236462137072 , 9.052616780315887 ],
[ 41.017856762845234 , 34.16280149039958 ],
[ 44.14394644352352 , 41.01138959072283 ],
[ 27.643252598741178 , 59.70500981994688 ],
[ 44.64573065314056 , 30.461743028419875 ],
[ 48.66269665416522 , 16.699450297408386 ],
[ 31.391885572994738 , 40.79551067370235 ],
[ 24.51821677463754 , 23.700683125259317 ],
[ 13.15510837430214 , 37.636775325784825 ],
[ 20.672259722910457 , 21.837542094907967 ],
[ 8.098695464418249 , 9.91022149907298 ],
[ 6.561151577664404 , 14.869498872783677 ],
[ 21.53505512328171 , 19.066321214492433 ],
[ 17.633950028556104 , 5.980821519125357 ],
[ 51.65414948849605 , 37.392236013401785 ],
[ 21.138132363884722 , 10.39517520513229 ],
[ 39.44484919926982 , 10.37386718366609 ],
[ 55.62439352475547 , 12.799666282262372 ],
[ 55.69298792704023 , 19.07289338173039 ],
[ 20.70705870536399 , 25.030184220176643 ],
[ 21.636744118731986 , 37.93835793210028 ],
[ 24.846510262267287 , 18.93804115595212 ],
[ 19.127996205158325 , 20.182431666452473 ],
[ 14.096993736306116 , 17.07612727832571 ],
[ 33.014103815841935 , 8.071251900454694 ],
[ 24.801724152639824 , 16.62243653263752 ],
[ 17.933043630558117 , 7.62008707200777 ],
[ 16.321860361562976 , 20.503235980797847 ],
[ 47.09322480790091 , 13.705838542258961 ],
[ 30.90241717329675 , 16.30527623706921 ],
[ 51.09301027619995 , 21.95730216158791 ],
[ 14.581820843304213 , 33.223014773616754 ],
[ 26.93587457714743 , 21.215078218101546 ],
[ 28.698253441292 , 36.98640690975033 ],
[ 21.78154099052284 , 31.968754780926563 ],
[ 31.100211217916335 , 15.105639248153782 ],
[ 18.389721829694125 , 32.67501420230036 ],
[ 21.560027098418445 , 25.745119423993838 ],
[ 21.958785395493106 , 32.75098516833626 ],
[ 38.11911570575863 , 19.24735882492222 ],
[ 27.001607567128367 , 48.08527493303654 ],
[ 37.61352711406686 , 40.57240838689323 ],
[ 11.698858467065044 , 39.98059464560538 ],
[ 13.731975959148038 , 4.725165474844475 ],
[ 22.251175722642486 , 8.837569312420674 ],
[ 12.192213296835966 , 13.019307631044025 ],
[ 8.599813365796306 , 37.83663408888615 ],
[ 14.513035708371394 , 36.229210513506715 ],
[ 30.857552068737213 , 42.01129439683673 ],
[ 29.048561104911993 , 65.31932158007025 ],
[ 47.248465020387144 , 27.208480937544618 ],
[ 66.51600580224535 , 41.12519882626315 ],
[ 23.934820803679397 , 30.193172970143582 ],
[ 27.8698690867465 , 28.882387144198432 ],
[ 19.51490407433131 , 25.824976550013773 ],
[ 16.091275164990062 , 28.219648952066834 ],
[ 25.438669422404242 , 13.42373111917906 ],
[ 25.438669422404242 , 13.42373111917906 ],
[ 46.3932821806162 , 8.704762956473818 ],
[ 18.81569942272938 , 54.96391305335933 ],
[ 22.667063200756235 , 56.60694426855387 ],
[ 33.07728857533929 , 8.43146820173525 ],
[ 7.027048279719873 , 17.072062022182237 ],
[ 12.020550986083993 , 31.550136990870755 ],
[ 12.316888503155525 , 36.96152413499671 ],
[ 25.061441553239604 , 29.29505761512764 ],
[ 16.30673759069662 , 32.864538470643716 ],
[ 12.686788912638715 , 29.111584031888867 ],
[ 18.85451717712794 , 41.16639166261592 ],
[ 23.086049985679548 , 16.7247749163055 ],
[ 42.97848779157653 , 20.40868738477775 ],
[ 13.22918612621072 , 75.72267452131553 ],
[ 11.38352110274627 , 19.436557335150102 ],
[ 13.054508290642412 , 31.37629037569203 ],
[ 24.822148074936504 , 59.600112819108304 ],
[ 21.05972608745296 , 29.1864734164172 ],
[ 11.347332848123584 , 29.88443283522791 ],
[ 20.45333029360159 , 25.89456039254459 ],
[ 114.46122239469378 , 12.96820467536116 ],
[ 109.98957425989555 , 11.254138084717543 ],
[ 128.31714129307016 , 21.685637304768537 ],
[ 73.6262386286943 , 18.496362886501256 ],
[ 49.82980397695119 , 7.0791445278024305 ],
[ 38.72628926368421 , 13.426577903695406 ],
[ 26.894933619275342 , 10.564787386788527 ],
[ 30.527784064029703 , 13.431958877199254 ],
[ 13.321976504504063 , 103.96448875949656 ],
[ 16.787772610610837 , 115.28390683811327 ],
[ 61.45438758633199 , 121.3272390281505 ],
[ 60.580934406229915 , 78.35237082165048 ],
[ 34.20603451457494 , 93.82176358260577 ],
[ 10.711848455796899 , 91.73763015696105 ],
[ 38.2540809213966 , 10.062477961552407 ],
[ 10.453994019492834 , 51.84696479105849 ],
[ 32.28612596134794 , 61.10221666391601 ],
[ 12.815725704705304 , 76.69648880668245 ],
[ 21.625627036452016 , 41.919084614843854 ],
[ 16.022709829540336 , 40.04879438609728 ],
[ 17.33138039219703 , 13.324380662713434 ],
[ 36.02511362640749 , 42.44470538423208 ],
[ 19.506326118670714 , 20.67273748592303 ],
[ 17.21640150876735 , 23.71325778620252 ],
[ 60.825909585569526 , 26.445764892491635 ],
[ 30.371237446229905 , 18.231536921876994 ],
[ 32.59589613979583 , 20.259364920359424 ],
[ 22.07704736342879 , 39.44700134565204 ],
[ 13.604250689906971 , 5.852929106882833 ],
[ 14.536376123259892 , 31.535350510647508 ],
[ 41.80952049426238 , 14.09119094937724 ],
[ 19.118975796981132 , 18.761743461934216 ],
[ 16.52808421542389 , 14.048401140671569 ],
[ 41.39704292250732 , 10.0911297297189 ],
[ 11.70370085463204 , 29.85392553086696 ],
[ 19.789843993871713 , 7.47941037242073 ],
[ 31.825823007840572 , 11.654245767391679 ],
[ 92.92428477283111 , 20.107871677360798 ],
[ 82.54865766030288 , 10.821968685747656 ],
[ 22.505178790413648 , 23.067984568145015 ],
[ 9.587160013188804 , 28.778252639251384 ],
[ 25.8921144061941 , 51.11712895803359 ],
[ 20.092230840355874 , 28.630300061475374 ],
[ 22.58313655489754 , 21.552406424491192 ],
[ 36.48574900911828 , 50.46428312129157 ],
[ 43.91345547749165 , 14.222121732585393 ],
[ 42.45003791216292 , 6.210602235124883 ],
[ 20.258625493953552 , 4.162113432156726 ],
[ 22.00312568926217 , 16.717156332808756 ],
[ 7.588703523450998 , 47.15150949844089 ],
[ 8.028604843865125 , 55.498720516505884 ],
[ 48.83589004520394 , 14.899201633630128 ],
[ 66.61296384972242 , 15.34937314763538 ],
[ 32.31734231914484 , 14.799452037918524 ],
[ 51.180814208280914 , 11.332965736488527 ],
[ 76.71439466026158 , 30.86221722158763 ],
[ 103.1051679815191 , 7.702754206515543 ],
[ 25.45386364151203 , 59.21810560356039 ],
[ 56.07201466748845 , 74.10242163044862 ],
[ 40.84346074691385 , 40.72274986247067 ],
[ 16.471973405505683 , 29.65777030879961 ],
[ 40.440786704542425 , 38.938991080189055 ],
[ 35.095003110910596 , 21.490365117848768 ],
[ 22.107193489528 , 24.706069149282808 ],
[ 33.5734270111663 , 34.19896774603356 ],
[ 14.142926911154465 , 23.555906701303215 ],
[ 49.75148862342147 , 9.988452102207432 ],
[ 18.614287300684687 , 16.20668330322099 ],
[ 10.656676956346661 , 10.328912615853342 ],
[ 22.990754060332304 , 32.61446362343254 ],
[ 13.933687646327268 , 14.590675704668937 ],
[ 15.803040149061063 , 20.763010715291962 ],
[ 20.03379683385965 , 19.445100072741667 ],
[ 36.599397432294694 , 11.877665950872986 ],
[ 13.571766350269666 , 15.677688135909726 ],
[ 26.25499195469544 , 6.846966686968432 ],
[ 8.206269807568399 , 11.42613698888291 ],
[ 27.656089683286098 , 19.60993648442198 ],
[ 14.3544148230403 , 29.43939906430366 ],
[ 13.737467703627289 , 23.61524444693342 ],
[ 19.60372605722999 , 62.558341612854655 ],
[ 19.843230425853744 , 38.47244805334166 ],
[ 30.40213890989429 , 7.500348249174088 ],
[ 15.72631123506303 , 26.010623076368987 ],
[ 13.538902225326593 , 23.465734545521894 ],
[ 18.665290008044057 , 38.475541449205664 ],
[ 60.72859143384578 , 29.831092293307137 ],
[ 41.052157751323875 , 62.35229540399075 ],
[ 68.76822686968815 , 13.138551665236815 ],
[ 23.936231674230577 , 50.870924837067115 ],
[ 16.397973696192054 , 37.285229316123726 ],
[ 22.452338716381732 , 16.173232533719233 ],
[ 58.27840288530233 , 20.424981843585595 ],
[ 61.3136019113515 , 32.971168124560364 ],
[ 32.30443132325254 , 36.30893393231339 ],
[ 13.35508024686996 , 35.88773332983521 ],
[ 39.09191732574681 , 18.442681200668886 ],
[ 22.221183130406917 , 10.634524643273616 ],
[ 13.456197275681895 , 29.990259562921466 ],
[ 49.860961005373284 , 34.30018921499874 ],
[ 68.00184968388511 , 29.31990017125192 ],
[ 39.65433877788713 , 25.059873567961546 ],
[ 32.95819873488402 , 18.227220789918306 ],
[ 31.189477278907383 , 27.593923360756403 ],
[ 13.907493058701254 , 39.2612317186125 ],
[ 20.273518240633038 , 42.33530594923879 ],
[ 26.927146154717377 , 31.115346997153868 ],
[ 23.847183716376435 , 18.923254718559967 ],
[ 18.03791325996897 , 9.699288709331357 ],
[ 10.73178953422679 , 30.67692363842106 ],
[ 25.406150199326166 , 32.59864917069574 ],
[ 45.85054283153021 , 6.882955028550278 ],
[ 32.60044632679129 , 40.79160128843696 ],
[ 23.02943107819528 , 70.60987622264152 ],
[ 15.375310313588484 , 70.4048074596244 ],
[ 45.65318101474514 , 63.34806305937874 ],
[ 22.049042645099384 , 20.66091253732551 ],
[ 19.581226639411234 , 30.392374243786 ],
[ 9.783381614639062 , 32.11628630494389 ],
[ 12.359002568738237 , 22.538712079829892 ],
[ 13.269695069311904 , 25.850744218506378 ],
[ 59.35671714265115 , 13.195485783814481 ],
[ 67.02952695609133 , 5.737661436061119 ],
[ 33.46428265113714 , 21.656684272507164 ],
[ 32.28370965237979 , 11.17344032686221 ],
[ 26.65329300258016 , 34.167844251663865 ],
[ 17.033862524404206 , 64.75906520524566 ],
[ 18.448656499557206 , 51.89935709155888 ],
[ 28.64650229685713 , 50.60128190867027 ],
[ 9.017383269244597 , 60.32547997363219 ],
[ 21.160545156878857 , 85.20574609875726 ],
[ 20.067599415491795 , 40.3819249857064 ],
[ 33.08457962215782 , 18.810320408267735 ],
[ 24.694439533560136 , 15.607408534131846 ],
[ 27.031072686378078 , 10.162538172037909 ],
[ 18.379362213858307 , 10.084238349717786 ],
[ 9.22776610751311 , 8.51506343677237 ],
[ 14.038491859239866 , 32.90910540021912 ],
[ 24.66223956584829 , 38.186841208660425 ],
[ 19.596355863571326 , 40.59976096857973 ],
[ 14.89628372853006 , 83.45190937908036 ],
[ 38.83318403457544 , 94.4463584854465 ],
[ 26.844330761834495 , 25.968965125232383 ],
[ 21.69263771107972 , 5.656498047077538 ],
[ 18.728266475342974 , 10.213899572484324 ],
[ 23.954237696893163 , 39.60906520254953 ],
[ 51.702421848654424 , 32.89895653246805 ],
[ 94.49039512991241 , 32.718629610141825 ],
[ 72.86644633389997 , 91.27896745896592 ],
[ 59.78609135562417 , 23.18363487185125 ],
[ 20.57740293173584 , 21.461026647197336 ],
[ 34.39672276996865 , 25.977508122697675 ],
[ 31.973866320617365 , 61.19511505205264 ],
[ 32.00818639118817 , 52.99486143862492 ],
[ 81.94221485948327 , 45.53091326262317 ],
[ 78.11367347961944 , 42.142527259810734 ],
[ 76.72084708197922 , 12.372135997841276 ],
[ 25.717549447633598 , 23.589266660786258 ],
[ 21.57216888006888 , 25.594925344339877 ],
[ 44.30224269025294 , 20.1510282240031 ],
[ 82.25616134217451 , 23.03549785373131 ],
[ 117.77414707851503 , 14.92095064542124 ],
[ 63.300700074446894 , 44.32087740669358 ],
[ 33.07011119292983 , 109.91265141901648 ],
[ 22.027210698406517 , 79.89083302106195 ],
[ 68.38198539520519 , 67.33239411457498 ],
[ 9.825332136939188 , 7.175808077169634 ],
[ 5.432285758024283 , 11.44129777831019 ],
[ 17.430444056273274 , 44.178467858553624 ],
[ 10.600656967918708 , 99.96689964614369 ],
[ 25.75351663055436 , 73.37142953194832 ],
[ 19.666398006380724 , 73.99315608512943 ],
[ 19.83286424516005 , 12.916596765940081 ],
[ 4.368983444829965 , 47.24173914257448 ],
[ 19.99604732083609 , 41.263555582572884 ],
[ 43.51719879912095 , 31.177616081620908 ],
[ 46.317165725195274 , 14.406723368921206 ],
[ 22.25348062342368 , 12.232179625600583 ],
[ 9.948872049620933 , 31.438989174996582 ],
[ 9.176747979272992 , 17.295868157149535 ],
[ 14.179564063505598 , 27.284327898962218 ],
[ 19.794226327442388 , 18.04632391936989 ],
[ 13.910718414744991 , 31.20787203457715 ],
[ 14.661450783504772 , 36.16333952306539 ],
[ 49.88579147211208 , 22.257789471145024 ],
[ 12.768066029632395 , 12.836593687337778 ],
[ 48.493411091975844 , 42.27647329355125 ],
[ 22.955907634562955 , 67.83955412152748 ],
[ 45.31548597090063 , 43.19490686945683 ],
[ 27.664273319695404 , 82.70695899352476 ],
[ 23.692701722254576 , 36.64123322160893 ],
[ 18.233528775661966 , 57.004454504991436 ],
[ 20.053375413342803 , 54.0296932622456 ],
[ 22.380883399736113 , 14.216158066234694 ],
[ 49.52221218469593 , 22.183286931607 ],
[ 14.421691921649991 , 31.989649428955218 ],
[ 10.287770075105636 , 22.053209816296636 ],
[ 22.071079477617932 , 22.69922749610988 ],
[ 20.248218116013014 , 30.907012316443737 ],
[ 23.430073326388026 , 14.737965061731824 ],
[ 58.63963269224398 , 34.12005690154148 ],
[ 18.91329855893622 , 34.5394450002291 ],
[ 13.400889766787184 , 5.497146070057212 ],
[ 38.58652901403804 , 21.50607470407801 ],
[ 28.580200746385152 , 25.663594106364787 ],
[ 15.681378353032732 , 16.394353633250805 ],
[ 8.624375872253118 , 19.628507153713542 ],
[ 15.204840591239574 , 15.00201464492845 ],
[ 23.05272145439638 , 15.572753939997074 ],
[ 15.49684584869645 , 9.237245559916346 ],
[ 21.67696633839781 , 26.20386132917254 ],
[ 36.25412931809732 , 25.056124338590458 ],
[ 16.370055350196964 , 55.57712124080783 ],
[ 58.18143074333987 , 22.508818674297878 ],
[ 47.42267887301941 , 24.60526545830954 ],
[ 14.855602141640636 , 33.827057462522305 ],
[ 30.269882295096807 , 18.80746577616965 ],
[ 47.76023450411142 , 14.174499973048487 ],
[ 36.05480513151895 , 22.291241424217556 ],
[ 55.5062195555391 , 16.772814289784513 ],
[ 33.70971219190323 , 121.10919337335278 ],
[ 14.121449807366451 , 62.56066160134206 ],
[ 33.345114039411044 , 19.07556914407885 ],
[ 53.93112910958662 , 15.110794527077518 ],
[ 17.662832630178983 , 56.92526267605936 ],
[ 24.61724587600773 , 18.388241187517455 ],
[ 21.45751784095416 , 41.71269152524246 ],
[ 4.806976207660764 , 19.5683189779159 ],
[ 4.578127229714087 , 15.761516577856653 ],
[ 24.338710377947216 , 4.858417601128341 ],
[ 27.916300387659994 , 24.648843301516752 ],
[ 36.05272580327337 , 11.841680081882796 ],
[ 17.285244304042923 , 8.19710402313886 ],
[ 33.61921925485672 , 17.854504432865753 ],
[ 11.975444596209448 , 86.20398597688423 ],
[ 17.057034431105823 , 71.94290985585344 ],
[ 37.75839492246446 , 24.117734795409564 ],
[ 23.143971920245907 , 25.89556593169168 ],
[ 19.98870023212513 , 37.090830928379546 ],
[ 7.239483124347103 , 15.21344697034328 ],
[ 23.601535121722296 , 24.246630902480124 ],
[ 17.590880772099315 , 12.40132975806609 ],
[ 19.59918084973801 , 23.486438945224965 ],
[ 47.24876261185169 , 32.58264649505459 ],
[ 54.36873589047896 , 8.651046027255655 ],
[ 12.583268736753514 , 37.64071231098098 ],
[ 11.182297052603936 , 31.668173097584337 ],
[ 17.142673183320962 , 35.897429901006504 ],
[ 13.71643325930193 , 25.455300165817455 ],
[ 66.939106817134 , 45.71676273168858 ],
[ 59.19301899531768 , 54.05804312149429 ],
[ 14.561692707367094 , 63.97286821913739 ],
[ 11.009636745338138 , 35.26747560592401 ],
[ 13.307506157349678 , 24.86594364915534 ],
[ 28.582631119984306 , 13.579159631869038 ],
[ 24.94661437416216 , 7.38685679924823 ],
[ 9.71650429419882 , 14.42058448160353 ],
[ 20.343076268898635 , 24.97546528847443 ],
[ 63.01475649384908 , 6.483917569793535 ],
[ 30.307943014091325 , 13.677510059306094 ],
[ 44.91326095109983 , 18.19533099537366 ],
[ 11.120488149066254 , 21.914961511985048 ],
[ 21.362107848260358 , 13.83728431383939 ],
[ 19.41540609287014 , 20.20524022106058 ],
[ 30.238804980537267 , 18.66849886547872 ],
[ 26.057970232074997 , 28.354701724691644 ],
[ 14.651499995637133 , 23.69690612459152 ],
[ 8.293252765843786 , 40.75822958639793 ],
[ 14.054478415117854 , 8.568830703424222 ],
[ 19.330884190474467 , 37.496361520853476 ],
[ 29.924908239533586 , 8.654147341150345 ],
[ 7.168984869059649 , 12.133353007076764 ],
[ 9.895681420467904 , 39.013424444656344 ],
[ 25.298480414692364 , 45.31144657204314 ],
[ 15.565669310335728 , 16.1218567353458 ],
[ 15.649213914859123 , 39.122324922328914 ],
[ 18.95555780897873 , 20.936938289278544 ],
[ 14.437959685779472 , 19.826164129405555 ],
[ 25.05728406418943 , 12.148353171907596 ],
[ 9.112172520795925 , 17.30018694319562 ],
[ 35.11906531641239 , 43.709908893977264 ],
[ 45.74854464937939 , 10.292789716996596 ],
[ 12.207199536934493 , 17.098623740148327 ]
]





delta_chi = []
plot_1 = []
plot_2 = []

for tkb in range(2,8):
        print(' ')
        nm=tkb
        nq=tkb

        split_m = []

        split_q = []

        i_ = 0
        sumq = []
        while len(split_m) < nm - 1:
            x = 0.
            for j in range(0,n_q): x = x + matrix[i_][j]
            sumq.append(x)
            
            if sum(sumq)>1./nm:
                if 1./nm - (sum(sumq) - x) >= sum(sumq) - 1./nm:
                    split_m.append(i_)
                else:
                    split_m.append(i_-1)
                sumq = []
            i_ = i_ + 1


        split_m.append(n_m-1)
        split_m.insert(0,0)

#        print(split_m)



        for k in range(0,nm):
            split_q.append([])
            j_ = 0
            summ = []
            while len(split_q[k]) < nq - 1:
                x = 0.
                for i in range(split_m[k],split_m[k+1]): x = x + matrix[i][j_]
                summ.append(x)
                if sum(summ)>1./(nm*nq):
                    if 1./(nm*nq) - (sum(summ) - x) >= sum(summ) - 1./(nm*nq):
                        split_q[k].append(j_)
                    else:
                        split_q[k].append(j_-1)
                    summ = []
                j_ = j_ + 1

            split_q[k].append(n_q-1)
            split_q[k].insert(0,0)
#        print(split_q)


        x = 0.
        grid_expectation_value = np.zeros((nm,nq))
        sum_log_i = []
        for k in range(0,nm):
            for l in range(0,nq):
                x = 0.
                y = 0.
                
                for i in range(split_m[k],split_m[k+1]):
                    for j in range(split_q[k][l],split_q[k][l+1]):
                        x = x + matrix[i][j]
                        y = y + logmatrix[i][j]
                if x * nm * nq < 0.8:
                    print('error is...')
                    print(x,k,l)
                sum_log_i.append(y/x)
                grid_expectation_value[k][l] = s_s * x
                
        """
        print('log expectation value for each grid is')
        print(sum_log_i)
        print('sum of it is')
        print(sum(sum_log_i))

        print('expectation value of log(mt) is')
        print(sum_logmt)

        print('numeriator of d\chi is')
        print(sum(sum_log_i)-nm*nq*sum_logmt)
        print((sum(sum_log_i)-nm*nq*sum_logmt)/np.sqrt(2*(nm*nq-1)))
        print(' ')
        """
        delta_chi.append([nm,nq,(sum(sum_log_i)-nm*nq*sum_logmt)/np.sqrt(2*(nm*nq-1))])
        
        
        
        
        plot_1.append(nm)
        plot_2.append((sum(sum_log_i)-nm*nq*sum_logmt)/np.sqrt(2*(nm*nq-1)))
        
        
            
        n = np.zeros((nm,nq))
        total = 0.0
        sum_v = 0.0

        for i in range(0,nm):
            for j in range(0,nq):
                sum_v = sum_v + grid_expectation_value[i][j]
                for k in range(0,s_s):
                    m_1 = samples[k][0]
                    m_2 = samples[k][1]
    #                z = samples[k][2]
                    m_total = m_1 + m_2
                    if m_1 < m_2:
                        q = m_1/m_2
                    else:
                        q = m_2/m_1
                    
                    if dm_t * split_m[i] + m_t_min < m_total and m_total < dm_t * split_m[i+1] + m_t_min and dq * split_q[i][j] + q_min < q and q < dq * split_q[i][j+1] + q_min:
                        n[i][j] = n[i][j] + 1.0
                        total = total + 1.0
        print(sum_v)
        kai_n = 0.0
        for i in range(0,nm):
            for j in range(i,nq):
                kai_n = kai_n + (n[i][j]-grid_expectation_value[i][j])**2.0/grid_expectation_value[i][j]
        print('the chi value is')
        print(kai_n)
        print(' ')
            

print(delta_chi)
plt.plot(plot_1,plot_2)
plt.show()


"""
#nm = 3
#nq = 3
#nm = 4
#nq = 4
#nm = 5
#nq = 5
#nm = 6
#nq = 6
nm=7
nq=7

split_m = []

split_q = []

i_ = 0
sumq = []
while len(split_m) < nm - 1:
    x = 0.
    for j in range(0,n_q): x = x + matrix[i_][j]
    sumq.append(x)
    
    if sum(sumq)>1./nm:
        if 1./nm - (sum(sumq) - x) >= sum(sumq) - 1./nm:
            split_m.append(i_)
        else:
            split_m.append(i_-1)
        sumq = []
    i_ = i_ + 1


split_m.append(n_m-1)
split_m.insert(0,0)

print(split_m)



for k in range(0,nm):
    split_q.append([])
    j_ = 0
    summ = []
    while len(split_q[k]) < nq - 1:
        x = 0.
        for i in range(split_m[k],split_m[k+1]): x = x + matrix[i][j_]
        summ.append(x)
        if sum(summ)>1./(nm*nq):
            if 1./(nm*nq) - (sum(summ) - x) >= sum(summ) - 1./(nm*nq):
                split_q[k].append(j_)
            else:
                split_q[k].append(j_-1)
            summ = []
        j_ = j_ + 1

    split_q[k].append(n_q-1)
    split_q[k].insert(0,0)
print(split_q)


x = 0.

sum_log_i = []
for k in range(0,nm):
    for l in range(0,nq):
        x = 0.
        y = 0.
        
        for i in range(split_m[k],split_m[k+1]):
            for j in range(split_q[k][l],split_q[k][l+1]):
                x = x + matrix[i][j]
                y = y + logmatrix[i][j]
        sum_log_i.append(y/x)
        print(x)
print('log expectation value for each grid is')
print(sum_log_i)
print('sum of it is')
print(sum(sum_log_i))

print('expectation value of m_t is')
print(mav/sum_int)
print('expectation value of log(mt) is')
print(sum_logmt/sum_int)


uhei = 0.

for i in range(0,n_m):
    for j in range(0,n_q):
        uhei = uhei + logmatrix[i][j]

print('numeriator of d\chi is')
print(sum(sum_log_i)-nm*nq*sum_logmt/sum_int)
print(sum(sum_log_i)-nm*nq*uhei)
"""




#次にやるべきことは、グリッドを決める作業ね。p=1の場合だけど...
#p≠1の場合だと、そもそもmatrixを求めるのに莫大な計算時間を要する可能性もあるね。。どうしようかね。まぁそこは仕方ないってことで。
#後やるべきなのは、p=1の時の分布関数とp≠1の時の分布関数にどの程度の差があるのかは知っておきたいよね。もし差がないなら最適なKの評価はp=1の場合でやれば良さげだしね。（もちろん質量関数によるか。。。）
